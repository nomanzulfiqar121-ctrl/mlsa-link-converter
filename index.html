<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOMAN | MLSA Converter</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Cinzel:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <style>
        :root {
            --primary-color: #0078d4;
            --bg-color: #1a1c1e; 
            --card-color: #25282c; 
            --input-bg: #121416;
            --peach-color: #FFDAB9; 
        }
        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px 0;
            display: flex;
            justify-content: center;
            background: var(--bg-color);
            color: white;
        }
        .card {
            background: var(--card-color);
            padding: 35px;
            border-radius: 24px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 450px;
            text-align: center;
            border: 1px solid #33383e;
        }
        
        .logo-section { margin-bottom: 35px; }
        .arabic-style { font-family: 'Great Vibes', cursive; font-size: 75px; line-height: 1; margin-bottom: -10px; color: #ffffff; display: block; }
        .english-name { font-family: 'Cinzel', serif; font-size: 22px; letter-spacing: 10px; color: #0078d4; text-transform: uppercase; padding-top: 10px; display: inline-block; }

        .instruction-box { background: rgba(0, 120, 212, 0.08); border-radius: 12px; padding: 15px; text-align: left; margin-bottom: 25px; border: 1px solid rgba(0, 120, 212, 0.2); }
        .instruction-box h3 { font-size: 13px; margin: 0 0 8px 0; color: #00c2ff; }
        .instruction-box ol { font-size: 13px; margin: 0; padding-left: 18px; color: #bdc3c7; }

        .input-group { text-align: left; margin-bottom: 18px; }
        label { color: #8892b0; font-size: 11px; font-weight: bold; margin-bottom: 6px; display: block; letter-spacing: 1.5px; }
        input { width: 100%; padding: 14px; background: var(--input-bg); border: 1px solid #3d444d; border-radius: 10px; color: white; box-sizing: border-box; transition: 0.3s; }
        input:focus { border-color: var(--primary-color); outline: none; }
        
        .btn { width: 100%; padding: 16px; background: linear-gradient(135deg, #0078d4 0%, #00c2ff 100%); color: white; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; margin-top: 10px; text-transform: uppercase; }

        #result-box { margin-top: 25px; padding: 20px; background: #121416; border-radius: 12px; display: none; border: 1px solid #0078d4; }
        .final-url { color: #00c2ff; word-break: break-all; font-size: 13px; margin-bottom: 15px; }

        #qrcode img { border: 10px solid white; border-radius: 8px; margin: 20px auto; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }

        .history-item { background: #121416; padding: 12px; border-radius: 10px; margin-bottom: 10px; border-left: 3px solid var(--peach-color); display: flex; justify-content: space-between; align-items: center; }
        .history-info { text-align: left; flex-grow: 1; margin-right: 10px; overflow: hidden; }
        .history-date { font-size: 10px; color: #8892b0; display: block; }
        .history-url { font-size: 11px; color: #ffffff !important; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; display: block; }

        .history-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .clear-btn { background: none; border: none; color: #ff4d4d; font-size: 10px; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; font-weight: bold; }

        /* Toast Styling üîî */
        #toast { visibility: hidden; min-width: 200px; background-color: #333; color: #fff; text-align: center; border-radius: 8px; padding: 12px; position: fixed; z-index: 1000; left: 50%; bottom: 30px; transform: translateX(-50%); font-size: 13px; border: 1px solid var(--peach-color); }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

        .links-section { margin-top: 30px; text-align: left; font-size: 12px; border-top: 1px solid #33383e; padding-top: 20px; }
        .links-section h4 { color: #bdc3c7; margin-bottom: 10px; text-transform: uppercase; font-size: 11px; }
        .links-section ul { color: #666; padding-left: 20px; margin: 0; }

        footer { margin-top: 30px; border-top: 1px solid #33383e; padding-top: 20px; }
        .dev-credit { color: #ffffff; font-size: 11px; margin-bottom: 10px; letter-spacing: 1px; font-weight: bold; }
        .social-links a { color: #8892b0; text-decoration: none; font-size: 12px; font-weight: bold; display: block; margin-top: 10px; }
    </style>
</head>
<body>

<div class="card">
    <div class="logo-section">
        <span class="arabic-style">Noman</span>
        <div class="english-name">NOMAN</div>
    </div>

    <div class="instruction-box">
        <h3>How to use:</h3>
        <ol>
            <li>Paste your Microsoft Learn URL.</li>
            <li>Enter your 6-digit Contributor ID.</li>
            <li>Convert and share your link!</li>
        </ol>
    </div>

    <div class="input-group">
        <label>YOUR CONTRIBUTOR ID</label>
        <input type="text" id="idInput" placeholder="Enter ID (e.g. 502891)">
    </div>

    <div class="input-group">
        <label>MICROSOFT LEARN LINK</label>
        <input type="text" id="urlInput" placeholder="Paste link here...">
    </div>
    
    <button class="btn" onclick="generateLink()">Create My Link</button>

    <div id="result-box">
        <label style="color:#8892b0">READY LINK:</label>
        <div id="finalLink" class="final-url"></div>
        <div id="qrcode" style="display: flex; justify-content: center;"></div>
        <button onclick="copyLink()" style="background:#fff; color:#000; border:none; padding:10px 25px; border-radius:8px; cursor:pointer; font-weight:bold; margin-top: 10px;">COPY URL</button>
    </div>

    <div id="history-box" style="margin-top: 25px; text-align: left; display: none;">
        <div class="history-header">
            <h4 style="color: var(--peach-color); font-size: 11px; letter-spacing: 1.5px; text-transform: uppercase; margin: 0;">Recent History</h4>
            <button class="clear-btn" onclick="clearAllHistory()">Clear All</button>
        </div>
        <div id="history-list"></div>
    </div>

    <div class="links-section">
        <h4>Eligible Reference URLs</h4>
        <ul>
            <li>learn.microsoft.com</li>
            <li>developer.microsoft.com</li>
            <li>azure.microsoft.com</li>
        </ul>
    </div>

    <footer>
        <div class="dev-credit">Designed and Developed by Noman Zulfiqar</div>
        <div class="social-links">
            <a href="https://www.linkedin.com/in/noman-zulfiqar-0916833a4" target="_blank">
                <i class="fab fa-linkedin"></i> CONNECT ON LINKEDIN
            </a>
        </div>
    </footer>
</div>

<div id="toast">Message here...</div>

<script>
    window.onload = function() { displayHistory(); };

    function showToast(msg) {
        const x = document.getElementById("toast");
        x.innerText = msg;
        x.className = "show";
        setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    }

    // üõ°Ô∏è URL Validation
    function isValidUrl(url) {
        const allowed = ["learn.microsoft.com", "developer.microsoft.com", "azure.microsoft.com"];
        return allowed.some(domain => url.includes(domain));
    }

    function generateLink() {
        const id = document.getElementById('idInput').value.trim();
        let url = document.getElementById('urlInput').value.trim();
        
        if (!id || !url) { showToast("‚ö†Ô∏è Dono boxes bharna zaroori hain!"); return; }
        if (!isValidUrl(url)) { showToast("‚ùå Sirf Microsoft ke links allow hain!"); return; }

        url = url.replace(/\/[a-z]{2}-[a-z]{2}\//i, '/');
        const separator = url.includes('?') ? '&' : '?';
        const finalUrl = `${url}${separator}wt.mc_id=studentamb_${id}`;
        
        document.getElementById('finalLink').innerText = finalUrl;
        document.getElementById('result-box').style.display = 'block';

        document.getElementById("qrcode").innerHTML = ""; 
        new QRCode(document.getElementById("qrcode"), { text: finalUrl, width: 150, height: 150 });

        saveToHistory(finalUrl);
        showToast("‚úÖ Link Generate Ho Gaya!");
    }

    function saveToHistory(newUrl) {
        let history = JSON.parse(localStorage.getItem("mlsa_history")) || [];
        const now = new Date();
        const dateStr = now.toLocaleDateString('en-GB', { day: '2-digit', month: 'short' });
        const timeStr = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });

        history.unshift({ url: newUrl, date: dateStr, time: timeStr });
        if (history.length > 5) history.pop();

        localStorage.setItem("mlsa_history", JSON.stringify(history));
        displayHistory();
    }

    function displayHistory() {
        const history = JSON.parse(localStorage.getItem("mlsa_history")) || [];
        const listDiv = document.getElementById("history-list");
        const box = document.getElementById("history-box");

        if (history.length === 0) { box.style.display = "none"; return; }
        box.style.display = "block";
        listDiv.innerHTML = ""; 

        history.forEach((item, index) => {
            const itemHtml = `
                <div class="history-item">
                    <div class="history-info">
                        <span class="history-url">${item.url}</span>
                        <span class="history-date">${item.date} | ${item.time}</span>
                    </div>
                    <div style="display:flex; gap:10px;">
                        <button onclick="copySpecific('${item.url}')" style="background:none; border:none; color:#FFDAB9; cursor:pointer;"><i class="fas fa-copy"></i></button>
                        <button onclick="deleteSingle(${index})" style="background:none; border:none; color:#ff4d4d; cursor:pointer;"><i class="fas fa-trash"></i></button>
                    </div>
                </div>
            `;
            listDiv.innerHTML += itemHtml;
        });
    }

    // üöÆ Individual Delete
    function deleteSingle(index) {
        let history = JSON.parse(localStorage.getItem("mlsa_history"));
        history.splice(index, 1);
        localStorage.setItem("mlsa_history", JSON.stringify(history));
        displayHistory();
        showToast("üóëÔ∏è Link Delete Ho Gaya!");
    }

    function clearAllHistory() {
        if (confirm("Poori history saaf karein?")) {
            localStorage.removeItem("mlsa_history");
            displayHistory();
            showToast("üßπ History Clear!");
        }
    }

    function copySpecific(text) {
        navigator.clipboard.writeText(text);
        showToast("üìã Link Copied!");
    }

    function copyLink() {
        const linkText = document.getElementById('finalLink').innerText;
        navigator.clipboard.writeText(linkText);
        showToast("üìã URL Copied!");
    }
</script>
</body>
</html>
